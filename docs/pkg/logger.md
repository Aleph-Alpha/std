<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# logger

```go
import "gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/pkg/logger"
```

Package logger provides structured logging functionality for Go applications.

The logger package is designed to provide a standardized logging approach with features such as log levels, contextual logging, distributed tracing integration, and flexible output formatting. It integrates with the fx dependency injection framework for easy incorporation into applications.

Core Features:

- Structured logging with key\-value pairs
- Support for multiple log levels \(Debug, Info, Warn, Error, etc.\)
- Context\-aware logging for request tracing
- Distributed tracing integration with OpenTelemetry
- Automatic trace and span ID extraction from context
- Configurable output formats \(JSON, text\)
- Integration with common log collection systems

Basic Usage:

```
import "gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/pkg/logger"

// Create a new logger using factory
log := logger.NewLoggerClient(logger.Config{
	Level:         "info",
	EnableTracing: true,
})

// Log with structured fields (without context)
log.Info("User logged in", err, map[string]interface{}{
	"user_id": "12345",
	"ip":      "192.168.1.1",
})

// Log with trace context (automatically includes trace_id and span_id)
log.InfoWithContext(ctx, "Processing request", nil, map[string]interface{}{
	"request_id": "abc-123",
	"user_id":    "12345",
})

// Log different levels
log.Debug("Debug message", nil, nil) // Only appears if level is Debug
log.Info("Info message", nil, nil)
log.Warn("Warning message", nil, nil)
log.Error("Error message", err, nil)

// Context-aware logging methods
log.DebugWithContext(ctx, "Debug with trace", nil, nil)
log.WarnWithContext(ctx, "Warning with trace", nil, nil)
log.ErrorWithContext(ctx, "Error with trace", err, nil)
```

FX Module Integration:

This package provides an fx module for easy integration with applications using the fx dependency injection framework:

```
app := fx.New(
	logger.Module,
	// ... other modules
)
app.Run()
```

Configuration:

The logger can be configured via environment variables:

```
ZAP_LOGGER_LEVEL=debug          # Log level (debug, info, warning, error)
LOGGER_ENABLE_TRACING=true      # Enable distributed tracing integration
```

Tracing Integration:

When tracing is enabled \(EnableTracing: true\), the logger will automatically extract trace and span IDs from the context and include them in log entries. This provides correlation between logs and distributed traces in your observability system.

The following fields are automatically added to log entries when tracing is enabled:

- trace\_id: The OpenTelemetry trace ID
- span\_id: The OpenTelemetry span ID

To use tracing, ensure your application has OpenTelemetry configured and pass context with active spans to the \*WithContext logging methods.

Performance Considerations:

The logger is designed to be performant with minimal allocations. However, be mindful of excessive debug logging in production environments.

Thread Safety:

All methods on the Logger interface are safe for concurrent use by multiple goroutines.

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func RegisterLoggerLifecycle\(lc fx.Lifecycle, client \*Logger\)](<#RegisterLoggerLifecycle>)
- [type Config](<#Config>)
- [type Logger](<#Logger>)
  - [func NewLoggerClient\(cfg Config\) \*Logger](<#NewLoggerClient>)
  - [func \(l \*Logger\) Debug\(msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.Debug>)
  - [func \(l \*Logger\) DebugWithContext\(ctx context.Context, msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.DebugWithContext>)
  - [func \(l \*Logger\) Error\(msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.Error>)
  - [func \(l \*Logger\) ErrorWithContext\(ctx context.Context, msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.ErrorWithContext>)
  - [func \(l \*Logger\) Fatal\(msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.Fatal>)
  - [func \(l \*Logger\) FatalWithContext\(ctx context.Context, msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.FatalWithContext>)
  - [func \(l \*Logger\) Info\(msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.Info>)
  - [func \(l \*Logger\) InfoWithContext\(ctx context.Context, msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.InfoWithContext>)
  - [func \(l \*Logger\) Warn\(msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.Warn>)
  - [func \(l \*Logger\) WarnWithContext\(ctx context.Context, msg string, err error, fields ...map\[string\]interface\{\}\)](<#Logger.WarnWithContext>)


## Constants

<a name="Debug"></a>Log level constants that define the available logging levels. These string constants are used in configuration to set the desired log level.

```go
const (
    // Debug represents the most verbose logging level, intended for development and troubleshooting.
    // When the logger is set to Debug level, all log messages (Debug, Info, Warning, Error) will be output.
    Debug = "debug"

    // Info represents the standard logging level for general operational information.
    // When the logger is set to Info level, Info, Warning, and Error messages will be output, but Debug messages will be suppressed.
    Info = "info"

    // Warning represents the logging level for potential issues that aren't errors.
    // When the logger is set to Warning level, only Warning and Error messages will be output.
    Warning = "warning"

    // Error represents the logging level for error conditions.
    // When the logger is set to Error level, only Error messages will be output.
    Error = "error"
)
```

## Variables

<a name="FXModule"></a>FXModule defines the Fx module for the logger package. This module integrates the logger into an Fx\-based application by providing the logger factory and registering its lifecycle hooks.

The module:

1. Provides the NewLoggerClient factory function to the dependency injection container, making the logger available to other components
2. Invokes RegisterLoggerLifecycle to set up proper cleanup during application shutdown

Usage:

```
app := fx.New(
    logger.FXModule,
    // other modules...
)
```

Dependencies required by this module: \- A logger.Config instance must be available in the dependency injection container

```go
var FXModule = fx.Module("logger",
    fx.Provide(
        NewLoggerClient,
    ),
    fx.Invoke(RegisterLoggerLifecycle),
)
```

<a name="RegisterLoggerLifecycle"></a>
## func [RegisterLoggerLifecycle](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/fx_module.go#L50>)

```go
func RegisterLoggerLifecycle(lc fx.Lifecycle, client *Logger)
```

RegisterLoggerLifecycle handles cleanup \(sync\) of the Zap logger. This function registers a shutdown hook with the Fx lifecycle system that ensures any buffered log entries are flushed when the application terminates.

Parameters:

- lc: The Fx lifecycle controller
- client: The logger instance to be managed

The lifecycle hook:

- OnStop: Calls Sync\(\) on the underlying Zap logger to flush any buffered logs to their output destinations before the application terminates

This ensures that no log entries are lost if the application shuts down while logs are still buffered in memory.

Note: This function is automatically invoked by the FXModule and does not need to be called directly in application code.

<a name="Config"></a>
## type [Config](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/configs.go#L25-L60>)

Config defines the configuration structure for the logger. It contains settings that control the behavior of the logging system.

```go
type Config struct {
    // Level determines the minimum log level that will be output.
    // Valid values are:
    //   - "debug": Most verbose, shows all log messages
    //   - "info": Shows info, warning, and error messages
    //   - "warning": Shows only warning and error messages
    //   - "error": Shows only error messages
    //
    // The default behavior is:
    //   - In production environments: defaults to "info"
    //   - In development environments: defaults to "debug"
    //   - In other/unspecified environments: defaults to "info"
    //
    // This setting can be configured via:
    //   - YAML configuration with the "level" key
    //   - Environment variable ZAP_LOGGER_LEVEL
    Level string `yaml:"level" envconfig:"ZAP_LOGGER_LEVEL"`

    // EnableTracing controls whether tracing integration is enabled for logging operations.
    // When set to true, the logger will automatically extract trace and span information
    // from context and include it in log entries. This provides correlation between
    // logs and distributed traces.
    //
    // When tracing is enabled, the following fields are automatically added to log entries:
    //   - "trace_id": The trace ID from the current span context
    //   - "span_id": The span ID from the current span context
    //
    // This setting can be configured via:
    //   - YAML configuration with the "enable_tracing" key
    //   - Environment variable LOGGER_ENABLE_TRACING
    EnableTracing bool `yaml:"enable_tracing" envconfig:"LOGGER_ENABLE_TRACING"`

    // ServiceName is the name of the service that is logging messages.
    // This value is used to populate the "service" field in log entries.
    ServiceName string
}
```

<a name="Logger"></a>
## type [Logger](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/setup.go#L14-L24>)

Logger is a wrapper around Uber's Zap logger. It provides a simplified interface to the underlying Zap logger, with additional functionality specific to the application's needs.

```go
type Logger struct {
    // Zap is the underlying zap.Logger instance
    // This is exposed to allow direct access to Zap-specific functionality
    // when needed, but most logging should go through the wrapper methods.
    Zap *zap.Logger
    // contains filtered or unexported fields
}
```

<a name="NewLoggerClient"></a>
### func [NewLoggerClient](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/setup.go#L53>)

```go
func NewLoggerClient(cfg Config) *Logger
```

NewLoggerClient initializes and returns a new instance of the logger based on configuration. This function creates a configured Zap logger with appropriate encoding, log levels, and output destinations.

Parameters:

- cfg: Configuration for the logger, including log level

Returns:

- \*Logger: A configured logger instance ready for use

The logger is configured with:

- JSON encoding for structured logging
- ISO8601 timestamp format
- Capital letter level encoding \(e.g., "INFO", "ERROR"\)
- Process ID and service name as default fields
- Caller information \(file and line\) included in log entries
- Output directed to stderr

If initialization fails, the function will call log.Fatal to terminate the application.

Example:

```
loggerConfig := logger.Config{
    Level: logger.Info,
}
log := logger.NewLoggerClient(loggerConfig)
log.Info("Application started", nil, nil)
```

<a name="Logger.Debug"></a>
### func \(\*Logger\) [Debug](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L108>)

```go
func (l *Logger) Debug(msg string, err error, fields ...map[string]interface{})
```

Debug logs a debug\-level message, useful for development and troubleshooting. Debug logs are typically more verbose and include information primarily useful during development or when diagnosing issues.

Parameters:

- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
logger.Debug("Processing request", nil, map[string]interface{}{
    "request_id": "abc-123",
    "payload_size": 1024,
    "processing_time_ms": 15,
})
```

<a name="Logger.DebugWithContext"></a>
### func \(\*Logger\) [DebugWithContext](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L213>)

```go
func (l *Logger) DebugWithContext(ctx context.Context, msg string, err error, fields ...map[string]interface{})
```

DebugWithContext logs a debug\-level message with trace context, useful for development and troubleshooting. This method automatically extracts trace and span IDs from the provided context when tracing is enabled.

Parameters:

- ctx: The context containing trace information
- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
logger.DebugWithContext(ctx, "Processing request", nil, map[string]interface{}{
    "request_id": "abc-123",
    "payload_size": 1024,
    "processing_time_ms": 15,
})
```

<a name="Logger.Error"></a>
### func \(\*Logger\) [Error](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L149>)

```go
func (l *Logger) Error(msg string, err error, fields ...map[string]interface{})
```

Error logs an error message, including details of the error and additional context fields. Use Error when something has gone wrong that affects the current operation but doesn't require immediate termination of the application.

Parameters:

- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
err := database.Connect()
if err != nil {
    logger.Error("Failed to connect to database", err, map[string]interface{}{
        "retry_count": 3,
        "database": "users",
    })
}
```

<a name="Logger.ErrorWithContext"></a>
### func \(\*Logger\) [ErrorWithContext](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L258>)

```go
func (l *Logger) ErrorWithContext(ctx context.Context, msg string, err error, fields ...map[string]interface{})
```

ErrorWithContext logs an error message with trace context, including details of the error and additional context fields. This method automatically extracts trace and span IDs from the provided context when tracing is enabled.

Parameters:

- ctx: The context containing trace information
- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
err := database.Connect()
if err != nil {
    logger.ErrorWithContext(ctx, "Failed to connect to database", err, map[string]interface{}{
        "retry_count": 3,
        "database": "users",
    })
}
```

<a name="Logger.Fatal"></a>
### func \(\*Logger\) [Fatal](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L172>)

```go
func (l *Logger) Fatal(msg string, err error, fields ...map[string]interface{})
```

Fatal logs a critical error message and terminates the application. Use Fatal only for errors that make it impossible for the application to continue running. This method will call os.Exit\(1\) after logging the message.

Parameters:

- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
configErr := LoadConfiguration()
if configErr != nil {
    logger.Fatal("Cannot start application without configuration", configErr, map[string]interface{}{
        "config_path": "/etc/myapp/config.json",
    })
}
```

Note: This function does not return as it terminates the application.

<a name="Logger.FatalWithContext"></a>
### func \(\*Logger\) [FatalWithContext](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L285>)

```go
func (l *Logger) FatalWithContext(ctx context.Context, msg string, err error, fields ...map[string]interface{})
```

FatalWithContext logs a critical error message with trace context and terminates the application. This method automatically extracts trace and span IDs from the provided context when tracing is enabled. Use Fatal only for errors that make it impossible for the application to continue running. This method will call os.Exit\(1\) after logging the message.

Parameters:

- ctx: The context containing trace information
- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
configErr := LoadConfiguration()
if configErr != nil {
    logger.FatalWithContext(ctx, "Cannot start application without configuration", configErr, map[string]interface{}{
        "config_path": "/etc/myapp/config.json",
    })
}
```

Note: This function does not return as it terminates the application.

<a name="Logger.Info"></a>
### func \(\*Logger\) [Info](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L88>)

```go
func (l *Logger) Info(msg string, err error, fields ...map[string]interface{})
```

Info logs an informational message, along with an optional error and structured fields. Use Info for general application progress and successful operations.

Parameters:

- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
logger.Info("User logged in successfully", nil, map[string]interface{}{
    "user_id": 12345,
    "login_method": "oauth",
})
```

<a name="Logger.InfoWithContext"></a>
### func \(\*Logger\) [InfoWithContext](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L191>)

```go
func (l *Logger) InfoWithContext(ctx context.Context, msg string, err error, fields ...map[string]interface{})
```

InfoWithContext logs an informational message with trace context, along with an optional error and structured fields. This method automatically extracts trace and span IDs from the provided context when tracing is enabled.

Parameters:

- ctx: The context containing trace information
- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
logger.InfoWithContext(ctx, "User logged in successfully", nil, map[string]interface{}{
    "user_id": 12345,
    "login_method": "oauth",
})
```

<a name="Logger.Warn"></a>
### func \(\*Logger\) [Warn](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L127>)

```go
func (l *Logger) Warn(msg string, err error, fields ...map[string]interface{})
```

Warn logs a warning message, indicating potential issues that aren't necessarily errors. Warnings indicate situations that aren't failures but might need attention or could lead to problems if not addressed.

Parameters:

- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
logger.Warn("High resource usage detected", nil, map[string]interface{}{
    "cpu_usage": 85.5,
    "memory_usage_mb": 1024,
})
```

<a name="Logger.WarnWithContext"></a>
### func \(\*Logger\) [WarnWithContext](<https://gitlab.aleph-alpha.de/engineering/pharia-data-search/data-go-packages/blob/main/pkg/logger/utils.go#L234>)

```go
func (l *Logger) WarnWithContext(ctx context.Context, msg string, err error, fields ...map[string]interface{})
```

WarnWithContext logs a warning message with trace context, indicating potential issues that aren't necessarily errors. This method automatically extracts trace and span IDs from the provided context when tracing is enabled.

Parameters:

- ctx: The context containing trace information
- msg: The log message
- err: An error to include in the log entry, or nil if no error
- fields: Variable number of map\[string\]interface\{\} containing additional structured data

Example:

```
logger.WarnWithContext(ctx, "High resource usage detected", nil, map[string]interface{}{
    "cpu_usage": 85.5,
    "memory_usage_mb": 1024,
})
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
