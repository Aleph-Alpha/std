<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# embedding

```go
import "github.com/Aleph-Alpha/std/v1/embedding"
```

Package embedding provides a unified, high\-level API for computing text embeddings through the Aleph Alpha inference service.

### Overview

The package exposes a single public entrypoint, Client, which hides all low\-level HTTP details, endpoint paths, authentication, and model\-specific behavior.

A client is constructed using:

```
client, err := embedding.NewClient(cfg)
```

Once created, the client can generate embeddings via:

```
client.Create(ctx, "model-name", "hello")
```

or batch embeddings via:

```
client.Create(ctx, "model-name", "a", "b", "c")
```

This package exclusively supports OpenAI\-compatible embeddings via the /v1/embeddings endpoint.

### Configuration

Configuration is sourced from environment variables and constructed by:

```
cfg := embedding.NewConfig()
```

Required variables:

- EMBEDDING\_ENDPOINT Base URL of the inference service \(no trailing path or slash\).

- EMBEDDING\_SERVICE\_TOKEN Internal PHARIA service token for authentication.

Optional variables:

- EMBEDDING\_HTTP\_TIMEOUT\_SECONDS Request timeout \(default: 30 seconds\).

Configuration correctness can be verified via:

```
if err := cfg.Validate(); err != nil { ... }
```

### Dependency Injection \\\(Fx\\\)

A ready\-to\-use Fx module is provided:

```
embedding.FXModule
```

which supplies:

- \*embedding.Config
- \*embedding.Client

and registers a lifecycle hook to clean up HTTP resources on shutdown.

Example:

```
app := fx.New(
    embedding.FXModule,
    fx.Invoke(func(c *embedding.Client) {
        // Use embeddings
    }),
)
```

### Summary

The embedding package provides:

- A clean, stable API for OpenAI\-compatible embeddings.
- A no\-leak abstraction over the Aleph Alpha inference service.

Usage:

```
client := embedding.NewClient(cfg)
client.Create(ctx, "model-name", texts...)
```

## Index

- [Variables](<#variables>)
- [func RegisterEmbeddingLifecycle\(lc fx.Lifecycle, client \*Client\)](<#RegisterEmbeddingLifecycle>)
- [type Client](<#Client>)
  - [func NewClient\(cfg \*Config\) \(\*Client, error\)](<#NewClient>)
  - [func \(c \*Client\) Close\(\) error](<#Client.Close>)
  - [func \(c \*Client\) Create\(ctx context.Context, token, model string, texts ...string\) \(\[\]\[\]float64, error\)](<#Client.Create>)
- [type Config](<#Config>)
  - [func NewConfig\(\) \*Config](<#NewConfig>)
  - [func \(c \*Config\) Validate\(\) error](<#Config.Validate>)
- [type InferenceProvider](<#InferenceProvider>)
  - [func \(p \*InferenceProvider\) Create\(ctx context.Context, token, model string, texts ...string\) \(\[\]\[\]float64, error\)](<#InferenceProvider.Create>)
- [type Provider](<#Provider>)


## Variables

<a name="FXModule"></a>FXModule wires the embedding system into Fx.

It provides:

- Config \(NewConfig\)
- Provider \(via provider factory\)
- \*Client \(NewClient\)
- Lifecycle hook \(RegisterEmbeddingLifecycle\)

```go
var FXModule = fx.Module(
    "embedding",

    fx.Provide(
        NewConfig,
        NewClient,
    ),

    fx.Invoke(RegisterEmbeddingLifecycle),
)
```

<a name="RegisterEmbeddingLifecycle"></a>
## func [RegisterEmbeddingLifecycle](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/fx_module.go#L33>)

```go
func RegisterEmbeddingLifecycle(lc fx.Lifecycle, client *Client)
```

RegisterEmbeddingLifecycle ensures that the Client \(and its provider\) are properly cleaned up on application shutdown.

<a name="Client"></a>
## type [Client](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/client.go#L12-L14>)

Client is the public entrypoint for computing embeddings.

It hides all provider details \(inference endpoints, HTTP, etc.\) from the application layer.

```go
type Client struct {
    // contains filtered or unexported fields
}
```

<a name="NewClient"></a>
### func [NewClient](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/client.go#L19>)

```go
func NewClient(cfg *Config) (*Client, error)
```

NewClient constructs a Client from Config. It validates the config and internally constructs the inference provider. Application code should depend on \*Client, not on Provider or inferenceProvider.

<a name="Client.Close"></a>
### func \(\*Client\) [Close](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/client.go#L39>)

```go
func (c *Client) Close() error
```

Close allows the client to release any internal resources used by the provider. Currently this is a no\-op unless the provider implements Close\(\).

<a name="Client.Create"></a>
### func \(\*Client\) [Create](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/client.go#L33>)

```go
func (c *Client) Create(ctx context.Context, token, model string, texts ...string) ([][]float64, error)
```

Create executes an embedding request for one or more texts.

<a name="Config"></a>
## type [Config](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/configs.go#L13-L17>)



```go
type Config struct {
    // Inference endpoint and auth
    Endpoint     string // Base URL of the Aleph Alpha inference API
    HTTPTimeoutS int    // HTTP timeout seconds (default 30)
}
```

<a name="NewConfig"></a>
### func [NewConfig](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/configs.go#L20>)

```go
func NewConfig() *Config
```

NewConfig reads from environment variables.

<a name="Config.Validate"></a>
### func \(\*Config\) [Validate](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/configs.go#L36>)

```go
func (c *Config) Validate() error
```

Validate ensures required fields are present.

<a name="InferenceProvider"></a>
## type [InferenceProvider](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/inference.go#L11-L14>)



```go
type InferenceProvider struct {
    // contains filtered or unexported fields
}
```

<a name="InferenceProvider.Create"></a>
### func \(\*InferenceProvider\) [Create](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/inference.go#L32>)

```go
func (p *InferenceProvider) Create(ctx context.Context, token, model string, texts ...string) ([][]float64, error)
```

Create generates embeddings for the given texts using the specified model. It uses the OpenAI\-compatible /v1/embeddings endpoint.

<a name="Provider"></a>
## type [Provider](<https://github.com/Aleph-Alpha/std/blob/main/v1/embedding/types.go#L6-L9>)

Provider contract

```go
type Provider interface {
    // Create generates embeddings for the given texts using the specified model.
    Create(ctx context.Context, token, model string, texts ...string) ([][]float64, error)
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
